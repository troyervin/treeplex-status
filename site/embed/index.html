<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>TreePlex Embed</title>
<style>
    body {
        margin: 0;
        padding: 20px;
        background: transparent;
        font-family: Arial, sans-serif;
        color: white;
    }
    .box {
        background: rgba(0,0,0,0.7);
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 15px;
    }
    .service {
        margin-bottom: 8px;
    }
</style>
</head>

<body>
<div class="box">
    <h2 id="live"></h2>
</div>

<div id="services"></div>

<script>
async function load() {
    try {
        const r = await fetch("https://status.treeplex.ca/api/summary.json");
        const data = await r.json();

        // Live status
        document.getElementById("live").innerText =
            data.status.allSystemsOperational
                ? "All systems operational"
                : "Issues detected";

        // Service table
        let html = "";
        data.services.forEach(s => {
            html += `
                <div class="box service">
                    <strong>${s.name}</strong><br>
                    Uptime: ${s.uptime}%<br>
                    Response: ${s.responseTime} ms
                </div>`;
        });

        document.getElementById("services").innerHTML = html;

    } catch (err) {
        document.body.innerHTML = "<div class='box'>Error loading status.</div>";
    }
}

load();
setInterval(load, 20000);
</script>

</body>
</html>
